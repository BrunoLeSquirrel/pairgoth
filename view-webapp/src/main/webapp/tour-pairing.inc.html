#set($roundPairing = $api.get("tour/${params.id}/pair/$round"))
#if($roundPairing.error)
<script type="text/javascript">
  onLoad(() => {
    showError("$roundPairing.error")
  });
</script>
  #set($pairables = [])
  #set($games = [])
  #set($unpairables = [])
#else
  #set($pairables = $roundPairing.pairables)
  #set($games = $roundPairing.games)
  #set($unpairables = $roundPairing.unpairables)
#end
<div class="tab-content" id="pairing-tab">
  <div id="pairing-content">
    <div id="pairing-round" class="active-round-box">
      Pairings for round
      <button class="ui floating choose-round prev-round button">&laquo;</button>
      <span class="active-round">$round</span>
      <button class="ui floating choose-round next-round button">&raquo;</button>
    </div>
    <div id="pairing-lists">
      <div id="pairing-left">
        <div id="pairables" class="multi-select" title="pairable players">
#foreach($p in $pairables)
  #set($part = $pmap[$p])
          <div data-id="$part.id" class="listitem pairable"><span>$part.name $part.firstname</span><span>#rank($part.rank) $part.country</span></div>
#end
        </div>
        <div id="unpairables" class="multi-select" title="unpairable players">
#foreach($p in $unpairables)
  #set($part = $pmap[$p])
          <div class="listitem unpairable" data-id="$part.id"><span>$part.name $part.firstname</span><span>#rank($part.rank) $part.country</span></div>
#end
        </div>
      </div>
      <div id="pairing-right">
        <div id="pairing-buttons">
          <button id="pair" class="ui blue right labeled icon floating button">
            <i class="angle double right icon"></i>
            Pair
          </button>
          <button id="unpair" class="ui orange right labeled icon floating button">
            <i class="angle double left icon"></i>
            Unpair
          </button>
        </div>
        <div id="paired" class="multi-select" title="white vs. black">
#foreach($game in $games)
  #set($white = $pmap[$game.w])
  #set($black = $pmap[$game.b])
          <div class="listitem game" data-id="$game.id">
            <div class="table">#$game.t</div>
            <div class="white">#if($white)$white.name $white.firstname#{else}BIP#end</div>
            <div class="levels">#if($white)#rank($white.rank)#end&nbsp;/&nbsp;#if($black)#rank($black.rank)#end</div>
            <div class="black">#if($black)$black.name $black.firstname#{else}BIP#end</div>
            <div class="handicap">#if($game.h)h$game.h#{else}&nbsp;#end</div>
          </div>
#end
        </div>
      </div>
    </div>
  </div>
</div>
